Drop support for python 3.7, update oldest supported dependencies and simplify code accordingly